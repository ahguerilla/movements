{% extends "base_v2.html" %}
{% load i18n %}

{% block header_padding %}{% endblock %}

{% block content %}
  <div id="translations">
    <div class="in-progress">
      <h3>{% trans 'Your Translations in Progress' %}</h3>
      <div class="list">
        <div class="ajaxloader">
          <img src="{{ STATIC_URL }}images/ajax-loader.gif"/>
        </div>
      </div>
    </div>
    <div class="needed">
        <h3>{% trans 'Translations Needed' %}</h3>
        <div class="list">
          <div class="ajaxloader">
            <img src="{{ STATIC_URL }}images/ajax-loader.gif"/>
          </div>
        </div>
    </div>
  </div>
{% endblock %}

{% block endjavascript %}
  <script type="text/template" id="user-translations-template">
    <% if (translations.length == 0) { %>
        <em>{% trans 'You are not currently working on any translations.' %}</em>
    <% } %>
    <% _.each(translations, function(translation, ix) { %>
       <div class="translation">
         <% if (translation.type == 'post') %>
         <div><a href="<%- translation.item_url %>" alt="Go to translation item" target="_blank">
             {% trans 'Translating post from ' %}
             <%- translation.from_code %>
             {% trans ' to ' %}
             <%- translation.to_code %>
           {% trans ' - go to item' %}
           </a></div>
         <div><strong>{% trans 'Original' %}</strong></div>
         <pre><%= translation.title %></pre>
         <div><strong>{% trans 'Candidate translation' %}</strong></div>
         <pre><%= translation.title_candidate %></pre>
       </div>
    <% if (ix < (translations.length - 1)) print('<hr/>');
       }); %>
  </script>
  <script type="text/template" id="available-translations-template">
    <% if (translations.length == 0) { %>
    <em>{% trans 'There is nothing that currently needs translating.' %}</em>
    <% } %>
    <% _.each(translations, function(translation) { %>
    TRANSLATION
    <% }); %>
  </script>
  <script type="text/javascript">
    $(document).ready(function () {
      new ahr.translations.TranslationsView({
        el: '#translations',
        translationLanguages: {{ translation_languages|safe }},
        is_cm: {{ user.userprofile.is_cm|yesno:"true,false" }},
        getUserTranslationsUrl: '{% url 'translation:translator:claimed_translations' %}',
        getAvailableTranslationsUrl: '{% url 'translation:translator:available_translations' %}'
      });
    });
  </script>
{% endblock %}